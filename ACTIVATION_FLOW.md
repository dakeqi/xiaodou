# 无LCD激活流程图

## 方案对比

```
┌─────────────────────────────────────────────────────────────┐
│                    激活方案对比表                            │
├──────────┬──────────┬──────────┬──────────┬──────────────┤
│ 方案     │ 难度     │ 用户体验 │ 硬件需求 │ 推荐场景      │
├──────────┼──────────┼──────────┼──────────┼──────────────┤
│ 串口输出 │ ★★☆☆☆   │ ★★☆☆☆   │ 电脑+线  │ 开发调试      │
│ WiFi热点 │ ★☆☆☆☆   │ ★★★★★   │ 手机     │ 普通用户      │
│ 语音播报 │ ★★★☆☆   │ ★★★★☆   │ 无       │ 盲人友好      │
│ 蓝牙配网 │ ★★★★☆   │ ★★★☆☆   │ 手机APP  │ 企业定制      │
│ 预激活   │ ★☆☆☆☆   │ ★★★★★   │ 无       │ 自用/送礼     │
└──────────┴──────────┴──────────┴──────────┴──────────────┘
```

## 方式1：串口激活流程

```
用户操作                          设备状态                    显示内容
   │                                 │                           │
   ├─> 1. 连接USB线                  │                           │
   │   （设备上电）                   │                           │
   │                                 │                           │
   │                                 ├─> 启动固件                │
   │                                 │                           │
   │                                 ├─> 检测未激活              │
   │                                 │                           │
   ├─> 2. 打开串口监控                │                           │
   │   idf.py monitor                │                           ├─> 输出激活信息
   │                                 │                           │   ==================
   │                                 │                           │   设备ID: 123456
   │                                 │                           │   激活码: ABC123
   │                                 │                           │   URL: https://...
   │                                 │                           │   ==================
   │                                 │                           │
   ├─> 3. 复制激活URL                │                           │
   │                                 │                           │
   ├─> 4. 浏览器访问URL              │                           │
   │   或APP输入激活码                │                           │
   │                                 │                           │
   │                                 ├─> 接收激活成功            │
   │                                 │                           │
   │                                 ├─> 保存激活信息            │
   │                                 │                           │
   ├─> 5. 配置WiFi                   │                           │
   │   （在网页或APP中）              │                           │
   │                                 │                           │
   │                                 ├─> 连接WiFi成功            │
   │                                 │                           ├─> "已连接WiFi"
   │                                 │                           │   "设备已就绪"
   │                                 ├─> LED常亮                 │
   │                                 │                           │
   ├─> 6. 开始使用                   │                           │
   │   "你好小智"                     │                           │
   │                                 ├─> 语音交互                │
   └──────────────────────────────────┴───────────────────────────┘
```

## 方式2：WiFi热点激活流程（推荐）

```
用户操作                          设备状态                    手机显示
   │                                 │                           │
   ├─> 1. 设备上电                   │                           │
   │                                 │                           │
   │                                 ├─> 启动固件                │
   │                                 │                           │
   │                                 ├─> 检测未激活              │
   │                                 │                           │
   │                                 ├─> 启动WiFi热点            │
   │                                 │   SSID: XiaoZhi-123456    │
   │                                 ├─> LED快闪（配网模式）     │
   │                                 │                           │
   ├─> 2. 手机搜索WiFi               │                           ├─> WiFi列表
   │                                 │                           │   ● XiaoZhi-123456
   │                                 │                           │   ○ 其他WiFi...
   │                                 │                           │
   ├─> 3. 连接设备热点               │                           │
   │   密码: 12345678                │                           │
   │                                 │                           │
   │                                 ├─> 接受连接                │
   │                                 │                           │
   │                                 ├─> 启动配网服务器          │
   │                                 │                           │
   │                                 │                           ├─> 自动打开页面
   │                                 │                           │   ┌─────────────┐
   │                                 │                           │   │ 小智设备激活│
   │                                 │                           │   ├─────────────┤
   │                                 │                           │   │  [二维码]   │
   │                                 │                           │   │ 激活码:     │
   │                                 │                           │   │  ABC123     │
   │                                 │                           │   ├─────────────┤
   │                                 │                           │   │ WiFi设置    │
   │                                 │                           │   │ SSID: ___   │
   │                                 │                           │   │ 密码: ___   │
   │                                 │                           │   │  [提交]     │
   │                                 │                           │   └─────────────┘
   ├─> 4. 扫描二维码                 │                           │
   │   （使用小智APP）                │                           │
   │                                 │                           │
   │                                 ├─> 接收激活成功            │
   │                                 │                           │
   ├─> 5. 输入家庭WiFi               │                           │
   │   在配网页面填写                 │                           │
   │                                 │                           │
   │                                 ├─> 连接家庭WiFi            │
   │                                 │                           │
   │                                 ├─> 关闭热点                │
   │                                 │                           │
   │                                 ├─> LED常亮（已连接）       │
   │                                 │                           │
   ├─> 6. 手机重新连回家庭WiFi        │                           │
   │                                 │                           │
   ├─> 7. 开始使用                   │                           │
   │   "你好小智"                     │                           │
   │                                 ├─> 语音交互                │
   └──────────────────────────────────┴───────────────────────────┘
```

## 方式3：语音播报激活流程

```
用户操作                          设备状态                    语音播报
   │                                 │                           │
   ├─> 1. 设备上电                   │                           │
   │                                 │                           │
   │                                 ├─> 启动固件                │
   │                                 │                           │
   │                                 ├─> 检测未激活              │
   │                                 │                           │
   │                                 ├─> TTS初始化               │
   │                                 │                           │
   │                                 ├─> 播放欢迎语              ├─> "您好，我是小智"
   │                                 │                           │   "请先激活设备"
   │                                 │                           │
   │                                 ├─> 播报激活码              ├─> "激活码是："
   │                                 │                           │   "A-B-C-1-2-3"
   │                                 │                           │   "请在小智APP"
   │                                 │                           │   "中输入激活码"
   │                                 │                           │
   │                                 ├─> LED慢闪（等待激活）     │
   │                                 │                           │
   ├─> 2. 短按BOOT键                 │                           │
   │   （没听清，重复播报）           │                           │
   │                                 │                           │
   │                                 ├─> 再次播报                ├─> "激活码是："
   │                                 │                           │   "A-B-C-1-2-3"
   │                                 │                           │
   ├─> 3. 打开小智APP                │                           │
   │   输入激活码                     │                           │
   │                                 │                           │
   │                                 ├─> 接收激活成功            │
   │                                 │                           │
   │                                 ├─> 播放成功提示            ├─> "激活成功！"
   │                                 │                           │   "请配置WiFi"
   │                                 │                           │
   ├─> 4. 在APP中配置WiFi            │                           │
   │                                 │                           │
   │                                 ├─> 连接WiFi                │
   │                                 │                           │
   │                                 ├─> LED常亮                 │
   │                                 │                           │
   │                                 ├─> 播放就绪提示            ├─> "WiFi已连接"
   │                                 │                           │   "可以开始使用了"
   │                                 │                           │
   ├─> 5. 开始使用                   │                           │
   │   "你好小智"                     │                           │
   │                                 ├─> 语音交互                │
   └──────────────────────────────────┴───────────────────────────┘
```

## LED状态指示

```
LED状态          │  含义                    │  用户应该做什么
────────────────┼─────────────────────────┼──────────────────────
快速闪烁(5Hz)    │  等待激活/配网            │  按照激活流程操作
慢速闪烁(1Hz)    │  正在连接WiFi            │  等待连接成功
常亮            │  已连接，待机中           │  可以说"你好小智"唤醒
呼吸灯效果       │  对话中                  │  可以开始说话
三次快闪         │  收到指令/处理中          │  等待回复
快速闪烁红色     │  错误/需要重置            │  长按BOOT键5秒重置
```

## 故障排查流程

```
问题: 无法激活
   │
   ├─> 检查1: 串口有输出吗？
   │       │
   │       ├─ 有 ──> 复制URL/激活码进行激活
   │       │
   │       └─ 无 ──> 检查USB线/驱动
   │
   ├─> 检查2: WiFi热点出现了吗？
   │       │
   │       ├─ 有 ──> 连接热点，打开配网页面
   │       │
   │       └─ 无 ──> 检查固件是否启用SoftAP
   │
   ├─> 检查3: 语音播报听到了吗？
   │       │
   │       ├─ 有 ──> 记录激活码，在APP中输入
   │       │
   │       └─ 无 ──> 检查扬声器连接
   │
   └─> 仍无法解决 ──> 提交Issue到GitHub
```

## 推荐实施顺序

```
阶段      │  功能                │  优先级  │  开发难度  │  用户体验
─────────┼─────────────────────┼─────────┼───────────┼──────────
第一阶段  │  串口输出激活信息     │  ★★★★★  │  ★☆☆☆☆    │  ★★☆☆☆
第二阶段  │  WiFi热点配网        │  ★★★★☆  │  ★★★☆☆    │  ★★★★★
第三阶段  │  语音播报激活码       │  ★★★☆☆  │  ★★★★☆    │  ★★★★☆
第四阶段  │  蓝牙配网（可选）     │  ★★☆☆☆  │  ★★★★★    │  ★★★☆☆
```

**建议**: 先实现第一阶段（串口输出），保证基本可用性；然后重点开发第二阶段（WiFi热点），提供最佳用户体验。
